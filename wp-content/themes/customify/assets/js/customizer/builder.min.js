!function(l,c){var r=l(document),U=Customify_Layout_Builder.is_rtl,i=function(n,s){var e={id:s,controlId:"",cols:12,cellHeight:45,items:[],container:null,ready:!1,devices:{desktop:"Desktop",mobile:"Mobile/Tablet"},activePanel:"desktop",panels:{},activeRow:"main",draggingItem:null,getTemplate:_.memoize(function(){var o=this,a={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(e,t,i){return _.isUndefined(t)&&(t="tmpl-customize-control-"+o.type),!_.isUndefined(i)&&_.isString(i)?a.variable=i:a.variable="data",_.template(l("#"+t).html(),null,a)(e)}}),drag_drop:function(){var n=this;l(".customify--device-panel",n.container).each(function(){var i=l(this),o=i.data("device"),a=[];n.panels[o]={},l(".customify--cb-items",i).each(function(e){var t,i=l(this).attr("data-id")||"";t=i?"_sid_"+o+"-"+i:"_sid_"+o+e,l(this).attr("id",t),a[e]="#"+t}),l(".grid-stack",i).each(function(){var e=l(this).attr("data-id")||"";n.panels[o][e]=l(this),l(this).droppable({out:function(e,t){},over:function(e,t){},drop:function(e,t){var i=l(this);n.gridster(i,t,e),n.save()}})});var e=l("#_sid_mobile-sidebar",i),t=e.attr("id")||!1;l(".customify-available-items .grid-stack-item",i).draggable({revert:"invalid",connectToSortable:!!t&&"#"+t,start:function(e,t){l("body").addClass("builder-item-moving"),l(".customify--cb-items",i).css("z-index",""),t.helper.parent().css("z-index",9999)},stop:function(e,t){l("body").removeClass("builder-item-moving"),l(".customify--cb-items",i).css("z-index",""),t.helper.parent().css("z-index","")}}),0<e.length&&(e.sortable({revert:!0,change:function(e,t){n.save()},receive:function(e,t){l(this).find(".grid-stack-item").removeAttr("style").attr("data-gs-width",1),n.save()}}),n.panels[o].sidebar=e),l(".customify-available-items .grid-stack-item",i).resizable({handles:"w, e",stop:function(e,t){n.setGridWidth(t.element.parent(),t),n.save()}})})},sortGrid:function(e){l(".grid-stack-item",e).each(function(){var e=l(this),t=e.attr("data-gs-x")||0;t=parseInt(t);var i=e.next();if(0<i.length){var o=i.attr("data-gs-x")||0;(o=parseInt(o))<t&&e.insertAfter(i)}})},getX:function(e){var t=e.attr("data-gs-x")||0;return parseInt(t)},getW:function(e,t){var i;return _.isUndefined(t)&&(t=!1),i=t?e.attr("data-df-width")||1:e.attr("data-gs-width")||1,parseInt(i)},gridGetItemInfo:function(e,t,i){var o,a=this.getX(e),n=this.getW(e),s=0,r=0,l=!1;for(o=a-1;0<=o&&!l;)0===t[o]?s++:l=!0,o--;for(l=!1,o=a+n;o<this.cols&&!l;)0===t[o]?r++:l=!0,o++;return{flag:t,x:a,w:n,item:e,before:s,after:r,id:e.attr("data-id")||"",wrapper:i}},updateItemsPositions:function(e){for(var t=this.cols,i=0;i<=t;i++)"object"!=typeof e[i]&&"function"!=typeof e[i]||e[i].attr("data-gs-x",i)},gridster:function(e,t,i){var o,g=[],m=this,p=this.cols,h=function(e){for(var t=e.x,i=e.w,o=e.el,a=t;a<t+i;a++)g[a]=a===t?o:1},l=function(e){for(var t=e.x,i=e.w,o=(e.el,t);o<t+i;o++)g[o]=0},w=function(e,t){for(var i=0,o=e;o<p;o++)if(0===g[o])i++;else if(t)return i;return i},b=function(e,t){var i=0;void 0===t&&(t=!1);for(var o=e;0<=o;o--)if(0===g[o])i++;else if(t)return i;return i},y=function(e){return 0===g[e]},x=function(e,t){for(var i=e;i<e+t;){if(0!==g[i])return!1;i++}return!0},C=function(e){if(e<0)return{x:-1,w:1};var t,i,o,a=-1;if(g[e]<=1)for(t=e,o=!1;0<=t&&!o;)1!==g[t]&&0!==g[t]&&(a=t,o=!0),t--;else a=e;for(t=a+1,i=a;1===g[t];)i++,t++;return{x:a,w:i+1-a}},I=function(e){var t,i,o,a=-1;if(g[e]<p)for(t=e,o=!1;t<p&&!o;)1!==g[t]&&0!==g[t]&&(a=t,o=!0),t++;else a=e;for(t=a+1,i=a;1===g[t];)i++,t++;return{x:a,w:i+1-a}},z=function(e,t){var i=g.slice(),o=b(e);if(0===o)return t;var a=C(e),n=0<=a.x?a.x+a.w-1:e,s=t;s=o<t?o:t;for(var r=0,l=0,c=n;l<=s&&0<=c;)0===g[c]&&(l++,r=c),c--;var d=[],f=0;for(c=r;c<=n;c++)(g[c]=0)!==i[c]&&(d[f]=i[c],f++);for(f=0,c=r;c<=n;c++)void 0!==d[f]?g[c]=d[f]:g[c]=0,f++;return t-s},k=function(e,t){var i=g.slice(),o=w(e);if(0===o)return t;var a=C(e),n=0<=a.x?a.x:e,s=t;s=t<=o?t:o;for(var r=e,l=0,c=n;l<s&&c<p;)0===g[c]&&(l++,r=c),c++;var d=[],f=0;for(c=n;c<=r;c++)(g[c]=0)!==i[c]&&(d[f]=i[c],f++);for(f=d.length-1,c=r;n<=c;c--)void 0!==d[f]?g[c]=d[f]:g[c]=0,f--;return t-s},D=function(){m.updateItemsPositions(g)},c=function(e,t){var i,o,a,n,d=e.x,s=e.w,r=function(){for(var e=0,t=0;t<p;t++)0===g[t]&&e++;return e}();if(r<=0)return!1;if(_.isUndefined(t)&&(t=!1),!t){if(y(d)){if(x(d,n=s))return h(e),e.el.attr("data-gs-x",d),e.el.attr("data-gs-width",n),!0;for((i=s<=(o=w(d,!0))+(a=b(d-1,!0))&&s-o<=a?d-(s-o):d-a)<0&&(i=0),console.log("_re",o),console.log("_le",a),console.log("__x",i);1<=n;){if(x(i,n))return console.log({x:i,w:n}),e.x=i,e.w=n,h(e),e.el.attr("data-gs-x",i),e.el.attr("data-gs-width",n),!0;n--}}if(1===g[d]){var l=C(d);if(0<=l.x&&d>l.x+Math.floor(l.w/2)&&d>l.x&&(i=l.x+l.w,o=w(i,!0),console.log("__re",o),console.log("__re_X",i),s<=o))return h({el:e.el,x:i,w:s}),e.el.attr("data-gs-x",i),e.el.attr("data-gs-width",s),!0}}console.log("--------------------------------------------------------");!function(e,t){var i,o,a,n,s=0,r=!1;if(console.log("insert at x",t),console.log("insert node",e),y(t)){if(console.log("empty_at_X",t),i=C(t),o=I(t),-1<i.x){if(console.log("found_item_left",i),(s=w(i.x))>=e.w)if(x(t,e.w))console.log("found",e),d=t,r=!0;else if(e.ox>t)for(a=i.x+i.w,n=(n=b(a))<=e.w?e.w-n:e.w,k(a+1,n),s=w(a),console.log("loop_start_i",a),r=!1;a>i.x+i.w&&!r;)x(a,e.w)&&(console.log("found_in_loop__i",a),d=a,r=!0),a--;if(!r&&e.ox<t){console.log("try_move_items_to_left",i),a=i.x+i.w-1,n=b(i.x),console.log("el",n),n>e.w&&(n=e.w),n-=2,z(i.x,n),console.log("try_move_items_to_left_flag",g),console.log("el2",n),a-=s=w(a),o=I(t);var l=i.x+i.w;for(-1<o.x&&(l=o.x),console.log("loop_start 2_i",a);a<l&&!r;)x(a,e.w)&&(console.log("found_in_loop__@__i",a),d=a,r=!0),a++}r||(d=i.x+i.w,e.w=s,e.x=d,console.log("resize_new_w",s),console.log("resize_new_x",d))}else if(-1<o.x){console.log("found_item_right",o),o=I(t),s=w(t,!1),console.log("move_all_item_to Right");var c=s>=e.w?e.w:s;for(k(t,c),a=o.x,console.log("loop_start Right",a);0<=a&&!r;)x(a,e.w)&&(d=a,e.x=d,r=!0,console.log("found_in_while_r",a)),a--;r||(d=t,e.w=s,e.x=d,console.log("resize_r_new_w",s),console.log("resize_r_new_x",d))}}else if(console.log("x is not empty"),i=C(t),e.ox<i.x)if(z(t,e.w),console.log("Move All items to left"),y(t))d=t;else{for(;!y(t)&&t<=m.cols-1;)t++;d=t}else if(k(t,e.w),console.log("Move All items to right"),y(t))d=t;else{for(;!y(t)&&0<=t;)t--;d=t}d>m.cols&&(d=m.cols-1),e.x=d,console.log("new node x",d)}(e,_.clone(d));var c,f=d,u=!1,v=0;for(d+s>m.cols-1&&(v=b(d,!0),console.log("le",v),0<v&&console.log("move_Left",d+s-m.cols-1)),D(),v=0;1<=s;){if(s<=r){if(x(d,s))return console.log("",{x:d,w:s}),e.w=s,h(e),e.el.attr("data-gs-x",d),e.el.attr("data-gs-width",s),!0;for(v=b(d,!(u=!1)),f=d-v,console.log("newX",f),c=f;c<p&&!u;){if(x(c,s))return console.log("Insert in While",{x:c,w:s}),e.w=s,h({el:e.el,x:c,w:s}),e.el.attr("data-gs-x",c),e.el.attr("data-gs-width",s),u=!0;c++}}s--}for(s=e.w,u=!1;1<=s;){for(c=0;c<p&&!u;){if(x(c,s))return console.log("Insert in While 2",{x:c,w:s}),h({el:e.el,x:c,w:s}),e.el.attr("data-gs-x",c),e.el.attr("data-gs-width",s),u=!0;c++}s--}return console.log("Insert END While",{x:c,w:s}),!1};o=(g=(m=this).getFlag(e)).slice();var a=e.offset();m.draggingItem=t.draggable;var n,s,r,d,f=e.width(),u=f/m.cols,v=0,P=t.offset;s=m.getW(t.draggable,!1),n=m.getW(t.draggable,!0),r=t.draggable.width(),console.log("DROP ITEM WIDTH",n),console.log("DROP ITEM cw WIDTH",s);var A=m.getX(t.draggable);U&&l({el:t.draggable,x:A,w:n});var S,T=0,R=0,W=!1;if(t.draggable.parent().is(e)?(d=!0,console.log("Item in this row"),n=s):(d=!1,console.log("Not in this row"),n<s&&(n=s)),U?(T=Math.round((a.left+f+10-i.clientX)/u),(R=Math.round((a.left+f-(P.left+r+10))/u))<0&&(R=0)):(T=Math.round((i.clientX-a.left)/u),(R=Math.round((P.left-a.left-10)/u))<0&&(R=0)),T>m.cols&&(T=m.cols),S=v=R,U)if(y(S))v=R,W=!0;else for(;S<m.cols&&!W;)y(S)?W=!0:S++;else if(y(v))v=R,W=!0;else{for(;v<=T&&!W;)y(v)?W=!0:v++;T<v&&(v=T)}if(W||(v=d?R:T),v<0&&(v=0),v+n>=m.cols){for(W=!0,S=v;S+n>m.cols&&W;)y(S)?S--:(S++,W=!1),console.log("loop_i",S);console.log("Find new _i, w: "+n,S),v=S}delete W,console.log("DROP Cursor",T),console.log("DROP row x cacl",v),console.log("DROP item w",n);var M={el:t.draggable,x:v,w:n,ox:A,ow:s};M.x<=0&&(M.x=0);var G=!1;d?(M.x=parseInt(t.draggable.attr("data-gs-x")||0),M.w=parseInt(t.draggable.attr("data-gs-width")||1),console.log("swap node",M),function(e,t){e.x;var i=e.w;l(e),console.log("Swap newX",t),console.log("Before Swap FLAG",g);var o=C(t),a=0;if(-1<o.x&&(a=o.x+o.w),x(t,i))return h({el:e.el,x:t,w:i});if(0<a&&x(a,i)&&a<=t){var n=I(t);if(-1<n.x&&e.w+t>=n.x)for(var s=_.clone(t);a<s;){if(x(s,i))return h({el:e.el,x:s,w:i});s--}if(t+i>m.cols){var r=m.cols-i;if(x(r,i))return h({el:e.el,x:r,w:i})}return h({el:e.el,x:a,w:i})}e.x=t,c(e,!0)}(M,v),G=!0):(G=c(M),console.log("Insert node")),G?(t.draggable.removeClass("item-from-list"),e.append(t.draggable),t.draggable.removeAttr("style"),console.log("DID Flag: ",g),m.draggingItem=null):(t.draggable.removeAttr("style"),console.log("Can not insert"),g=o),D(),m.updateAllGrids()},updateAllGrids:function(){var i=this;_.each(i.panels[i.activePanel],function(e,t){i.updateGridFlag(e)})},setGridWidth:function(e,t){var i,o,a=this,n=t.element,s=e.width(),r=t.size.width,l=t.originalSize.width,c=Math.ceil(s/a.cols)-1;o=U?(i=t.originalPosition.left>t.position.left,l!==r):(i=t.originalPosition.left>t.position.left,t.originalPosition.left<t.position.left);var d,f,u,v=t.originalElement.attr("data-gs-width")||1,g=t.originalElement.attr("data-gs-x")||0;v=parseInt(v),g=parseInt(g);var m,p=a.getFlag(e),h=a.gridGetItemInfo(t.originalElement,p,e);if(i)return U?(f=Math.floor((t.position.left-1)/c),(d=(f=a.cols-f)-g-v)>h.after&&(d=h.after),u=v+d,n.attr("data-gs-x",g).removeAttr("style")):((d=g-(f=Math.floor((t.position.left-1)/c)))>h.before&&(d=h.before),f=g-d,u=v+d,n.attr("data-gs-x",f).removeAttr("style")),n.attr("data-gs-width",u).removeAttr("style"),void a.updateGridFlag(e);if(o)return U?t.originalPosition.left!==t.position.left?(f=Math.floor((t.position.left-1)/c),v<(d=v+g-(f=a.cols-f))&&(d=0),u=v-d,(f=g)<=0&&(f=0),console.log("diffRight_RTL_COL_New __left")):(f=Math.ceil((t.position.left+t.size.width-11)/c),(d=g-(f=a.cols-f))>h.before&&(d=h.before),f=g-d,u=v+d):((u=v-(d=(f=Math.round((t.position.left-1)/c))-g))<=0&&(u=1,d=0),f=g+d),n.attr("data-gs-x",f).removeAttr("style"),n.attr("data-gs-width",u).removeAttr("style"),void a.updateGridFlag(e);var w,_=h.x;r<t.originalSize.width?((w=Math.round((t.position.left+t.size.width-11)/c))<=_&&(w=_+1),m=h.w-(_+h.w-w)):(w=Math.ceil((t.position.left+t.size.width-11)/c),m=h.w+(w-(_+h.w)),h.x+m>h.x+h.w+h.after&&(m=h.w+h.after)),m<=0&&(m=1),n.attr("data-gs-width",m).removeAttr("style"),a.updateGridFlag(e)},getFlag:function(e){var t,i=e.data("gridRowFlag")||[];if(_.isEmpty(i)){for(t=0;t<this.cols;t++)i[t]=0;e.data("gridRowFlag",i)}return i},updateGridFlag:function(e){var o,a=this,n=[];for(o=0;o<a.cols;o++)n[o]=0;return l(".grid-stack-item",e).each(function(e){l(this).removeAttr("style");var t=a.getX(l(this)),i=a.getW(l(this));for(o=t;o<t+i;o++)n[o]=o===t?l(this):1}),e.data("gridRowFlag",n),a.updateItemsPositions(n),a.sortGrid(e),n},addNewWidget:function(e,t){var i=this,o=i.container.find(".customify--device-panel.customify--panel-"+i.activePanel),a=t;_.isObject(a)||(a=o.find(".customify--cb-items").first());var n=e;n.draggable({revert:"invalid",appendTo:o,scroll:!1,zIndex:99999,handle:".grid-stack-item-content",start:function(e,t){l("body").addClass("builder-item-moving"),l(".customify--cb-items",o).css("z-index",""),t.helper.parent().css("z-index",9999)},stop:function(e,t){l("body").removeClass("builder-item-moving"),l(".customify--cb-items",o).css("z-index",""),i.save()},drag:function(e,t){}}).resizable({handles:"w, e",start:function(e,t){t.originalElement.css({right:"auto",left:t.position.left})},stop:function(e,t){i.setGridWidth(t.element.parent(),t),i.save()}}),a.append(n),i.updateGridFlag(a)},addPanel:function(e){var t=this.getTemplate(),i="tmpl-customify--cb-panel";if(0!=l("#"+i).length)return _.isObject(n.rows)||(n.rows={}),'<div class="customify--device-panel customify-vertical-panel customify--panel-'+e+'" data-device="'+e+'">'+t({device:e,id:n.id,rows:n.rows},i)+"</div>"},addDevicePanels:function(){var o=this;_.each(o.devices,function(e,t){var i=o.addPanel(t);l(".customify--cb-devices-switcher",o.container).append('<a href="#" class="switch-to switch-to-'+t+'" data-device="'+t+'">'+e+"</a>"),l(".customify--cb-body",o.container).append(i)}),l("#customify-upsell-tmpl").length&&l(l("#customify-upsell-tmpl").html()).insertAfter(l(".customify--cb-devices-switcher",o.container))},addItem:function(e){var t=this.getTemplate(),i="tmpl-customify--cb-item";if(0!=l("#"+i).length){var o=t(e,i);return l(o)}},addAvailableItems:function(){var s=this;_.each(s.devices,function(e,a){var n=l('<div class="customify-available-items" data-device="'+a+'"></div>');l(".customify--panel-"+a,s.container).append(n),_.each(s.items,function(e){var t=!0;if(!_.isUndefined(e.devices)&&!_.isEmpty(e.devices))if(_.isString(e.devices))e.devices!=a&&(t=!1);else{var i=!1;_.each(e.devices,function(e){a==e&&(i=!0)}),i||(t=!1)}if(t){var o=s.addItem(e);n.append(o)}})})},switchToDevice:function(e,t){var i=this;1<_.size(i.devices)?(l(".customify--cb-devices-switcher a",i.container).removeClass("customify--tab-active"),l(".customify--cb-devices-switcher .switch-to-"+e,i.container).addClass("customify--tab-active"),l(".customify--device-panel",i.container).addClass("customify--panel-hide"),l(".customify--device-panel.customify--panel-"+e,i.container).removeClass("customify--panel-hide"),i.activePanel=e):l(".customify--cb-devices-switcher a",i.container).addClass("customify--tab-active"),(_.isUndefined(t)||t)&&("desktop"==e?l("#customize-footer-actions .preview-desktop").trigger("click"):l("#customize-footer-actions .preview-mobile").trigger("click"))},addExistingRowsItems:function(){var s=this,t=c.control(s.controlId).params.value;_.isObject(t)||(t={}),_.each(s.panels,function(a,n){var e={};_.isObject(t[n])&&(e=t[n]),_.each(e,function(e,o){_.isUndefined(e)||_.each(e,function(e,t){var i=l('.customify-available-items[data-device="'+n+'"] .grid-stack-item[data-id="'+e.id+'"]').first();i.attr("data-gs-width",e.width),i.attr("data-gs-x",e.x),i.removeClass("item-from-list"),s.addNewWidget(i,a[o])})})}),s.ready=!0},focus:function(){this.container.on("click",".customify--cb-item-setting, .customify--cb-item-name, .item-tooltip",function(e){e.preventDefault();var t=l(this).data("section")||"",i=l(this).attr("data-control")||"",o=!1;i&&(_.isUndefined(c.control(i))||(c.control(i).focus(),o=!0)),o||t&&!_.isUndefined(c.section(t))&&(c.section(t).focus(),o=!0)}),this.container.on("click",".customify--cb-row-settings",function(e){e.preventDefault();var t=l(this).attr("data-id")||"",i=n.id+"_"+t;_.isUndefined(c.section(i))||c.section(i).focus()})},remove:function(){var o=this;r.on("click",".customify--device-panel .customify--cb-item-remove",function(e){e.preventDefault();var t=l(this).closest(".grid-stack-item"),i=t.closest(".customify--device-panel");t.attr("data-gs-width",1),t.attr("data-gs-x",0),t.removeAttr("style"),l(".customify-available-items",i).append(t),o.updateAllGrids(),o.save()})},encodeValue:function(e){return encodeURI(JSON.stringify(e))},decodeValue:function(e){return JSON.parse(decodeURI(e))},save:function(){var a=this;if(a.ready){var n={};_.each(a.panels,function(e,o){n[o]={},_.each(e,function(e,t){var i=_.map(l(" > .grid-stack-item",e),function(e){return e=l(e),{x:a.getX(e),y:1,width:a.getW(e),height:1,id:e.data("id")||""}});n[o][t]=i})}),c.control(a.controlId).setting.set(a.encodeValue(n))}},showPanel:function(){var t=this;this.container.removeClass("customify--builder--hide").addClass("customify--builder-show"),setTimeout(function(){var e=t.container.height();l("#customize-preview").addClass("cb--preview-panel-show").css({bottom:e-1,"margin-top":"0px"})},100)},hidePanel:function(){this.container.removeClass("customify--builder-show"),l("#customize-preview").removeClass("cb--preview-panel-show").removeAttr("style")},togglePanel:function(){var t=this;c.state("expandedPanel").bind(function(e){c.panel(n.panel).expanded()?(r.trigger("customify_panel_builder_open",[n.panel]),console.log("open-builder:",n.panel),top._current_builder_panel=s,t.showPanel()):t.hidePanel()}),t.container.on("click",".customify--panel-close",function(e){e.preventDefault(),t.container.toggleClass("customify--builder--hide"),t.container.hasClass("customify--builder--hide")?l("#customize-preview").removeClass("cb--preview-panel-show"):l("#customize-preview").addClass("cb--preview-panel-show")})},panelLayoutCSS:function(){var e=l("#customize-controls").width();c.state("paneVisible").get()||(e=0),U?this.container.find(".customify--cb-inner").css({"margin-right":e}):this.container.find(".customify--cb-inner").css({"margin-left":e})},init:function(e,t,i){var o=this,a=o.getTemplate()(n,"tmpl-customify--builder-panel");o.container=l(a),l("body .wp-full-overlay").append(o.container),o.controlId=e,o.items=t,o.devices=i,n.section&&c.section(n.section).container.addClass("customify--hide"),o.addDevicePanels(),o.switchToDevice(o.activePanel),o.addAvailableItems(),o.switchToDevice(o.activePanel),o.drag_drop(),o.focus(),o.remove(),o.addExistingRowsItems(),c.panel(n.panel).expanded()?(console.log("open-builder:",n.panel),o.showPanel()):o.hidePanel(),c.previewedDevice.bind(function(e){"desktop"===e?o.switchToDevice("desktop",!1):o.switchToDevice("mobile",!1)}),o.togglePanel(),c.state("paneVisible").get()&&o.panelLayoutCSS(),c.state("paneVisible").bind(function(){o.panelLayoutCSS()}),l(window).resize(_.throttle(function(){o.panelLayoutCSS()},100)),o.container.on("click",".customify--cb-devices-switcher a.switch-to",function(e){e.preventDefault();var t=l(this).data("device");o.switchToDevice(t)}),r.trigger("customify_builder_panel_loaded",[s,o])}};return e.init(n.control_id,n.items,n.devices),e};c.bind("ready",function(e,t){_.each(Customify_Layout_Builder.builders,function(e,t){new i(e,t)}),c.bind("pane-contents-reflowed",function(){setTimeout(function(){l("#sub-accordion-panel-widgets .no-widget-areas-rendered-notice .footer_moved_widgets_text").length||l("#sub-accordion-panel-widgets .no-widget-areas-rendered-notice").append('<p class="footer_moved_widgets_text">'+Customify_Layout_Builder.footer_moved_widgets_text+"</p>")},1e3)}),c.state("expandedSection").bind(function(e){l(".customify--device-panel .grid-stack-item").removeClass("item-active"),l(".customify--cb-row").removeClass("row-active"),e&&(l('.customify--cb-row[data-id="'+e.id+'"]').addClass("row-active"),l(".customify--device-panel .grid-stack-item.for-s-"+e.id).addClass("item-active"))})}),r.on("click",".focus-section",function(e){e.preventDefault();var t=l(this).attr("data-id")||"";t||(t=(t=l(this).attr("href")||"").replace("#","")),t&&c.section(t)&&c.section(t).focus()}),r.on("click",".focus-control",function(e){e.preventDefault();var t=l(this).attr("data-id")||"";t||(t=(t=l(this).attr("href")||"").replace("#","")),t&&c.control(t)&&c.control(t).focus()}),r.on("click",".focus-panel",function(e){e.preventDefault();var t=l(this).attr("data-id")||"";t||(t=(t=l(this).attr("href")||"").replace("#","")),t&&c.panel(t)&&c.panel(t).focus()}),r.on("click",".save-template-form .save-builder-template",function(e){e.preventDefault();var t=l(this).closest(".customize-control"),i=l(".template-input-name",t),o=i.val();o&&""!==o&&l.post(ajaxurl,{action:"customify_builder_save_template",name:i.val(),id:i.attr("data-builder-id")||"",control:i.attr("data-control-id")||"",preview_data:c.get()},function(e){e.success&&(i.val(""),t.find(".list-saved-templates").prepend(e.data.li),t.find(".list-saved-templates").addClass("has-templates"))})}),r.on("click",".list-saved-templates .saved_template .remove-tpl",function(e){e.preventDefault();var t=l(this).parent(),i=l(this).closest(".customize-control"),o=l(".template-input-name",i),a=t.data("id")||"";l.post(ajaxurl,{action:"customify_builder_save_template",id:o.attr("data-builder-id")||"",remove:a},function(e){t.remove(),i.find(".list-saved-templates li.saved_template").length<=0&&i.find(".list-saved-templates").removeClass("has-templates")})});r.on("click",".list-saved-templates .saved_template .load-tpl",function(e){e.preventDefault();var t=l(this).parent(),i=l.Deferred(),o=_.clone(window.location),a=t.data("control-id")||"",n=t.data("data")||{};_.isObject(n)||(n={}),_.each(n,function(e,t){var i;c.control(t)&&(_.isEmpty(e)||c.control(t).setting.set((i=e,encodeURI(JSON.stringify(i)))))});var s=l(".wp-full-overlay");s.addClass("customize-active full-overlay-active customize-loading");var r=function(){var e;if(!(0<c.state("processing").get()))return c.state("processing").unbind(r),(e=c.requestChangesetUpdate()).done(function(){l(window).off("beforeunload.customize-confirm"),top.location.href=o.origin+o.pathname+"?autofocus[control]="+a+"&url="+encodeURIComponent(c.previewer.previewUrl.get())+"&changeset_uuid="+c.settings.changeset.uuid,i.resolve()}),e.fail(function(){s.removeClass("customize-loading"),i.reject()}),i.promise()};0===c.state("processing").get()?r():c.state("processing").bind(r)}),r.on("mouseover",".customify--cb-row .grid-stack-item",function(e){var t=l(this),i=l(".customify--cb-item-remove",t).outerWidth()+l(".customify--cb-item-setting",t).outerWidth();l(".grid-stack-item-content",t).innerWidth()-50<i&&t.addClass("show-tooltip")}),r.on("mouseleave",".customify--cb-row .grid-stack-item",function(e){l(this).removeClass("show-tooltip")})}(jQuery,wp.customize||null);